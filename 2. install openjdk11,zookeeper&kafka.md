Pada kesempatan kali ini, saya akan mendokumentasikan bagaimana cara instalasi java 11 openjdk, zookeeper dan kafka ke dalam WSL yang telah di install dalam materi sebelumnya (CentOS 8). (Sebelum lanjut saya menjalankan semuanya dengan user root)
# A. Instalasi Java
langkah pertama yaitu memeriksa update yang ada dengan menggunakan perintah 
```
sudo yum update -y
```
selanjutnya masuk ke install java 11 dengan perintah:
```
sudo yum install -y java-11-openjdk-devel
```
tunggu sampai selesai, setelah selesai maka dapat di cek dengan perintah:
```
java -version
```
# B. Instalasi Zookeeper dan Java
1. terdapat beberapa cara dalam melakukan instalasi keduanya, sebelumnya saya telah mencoba untuk menginstall masing-masing namun tidak berhasil, jadi saya menginstallnya secara sekaligus dengan menggunakan kafka quickstart yang dimulai dengan mengunduh di situs wen kafka berikut: 
https://kafka.apache.org/quickstart
2. pilih kafka dengan versi terbaru yang sudah rilis kemudian copy link nya
 ![image](https://github.com/ferdyansahalfariz/belajar-linux/assets/96871156/856c75a0-6a42-4086-8321-09d2136f0a09)
3. buka centOS dan buat perintah:
```
wget https://dlcdn.apache.org/kafka/3.7.0/kafka_2.13-3.7.0.tgz
```
4. extract filenya
```
tar -xvzf kafka_2.13-3.7.0.tgz
```
5. pindahkan ke folder /opt/
```
mv kafka_2.13-3.7.0/opt/
```
# C. Running zookeeper dan kafka
untuk running, dimulai dengan zookeeper terlebih dahulu dengan perintah 
```
bin/zookeeper-server-start.sh config/zookeeper.properties
```
dengan tampilan seperti berikut:
![Screenshot (9)](https://github.com/ferdyansahalfariz/belajar-linux/assets/96871156/7ba99116-c700-4195-a3e5-5de9b4633b82)
kemudian tanpa menutup atau memberhentikan service yang berjalan di zookeeper, lakukan running untuk kafkanya dengan perintah
```
bin/kafka-server-start.sh config/server.properties
```
# D. Konfigurasi menggunakan Systemd
Pada kenyataannya, saya tidak dapat menjalankan kafka dengan cara diatas, jadi sebagai cara lainnya, saya menggunakan systemd yang dapat menjalankan kedua service tersebut secara bersamaan. terdapat beberapa konfigurasi yang dilakukan sebelumnya.
1. pastikan bahwa sudah terdapat systemd pada wsl di dalam wsl.conf dengan melakukan perintah :
```
sudo vim /etc/wsl.conf
```
jika dalam file tersebut belum ada maka tambahkan isian berikut dengan tombol 'i' untuk insert kemudian tambahkan:
```
[network]
generateHosts = false

#mount with options
[automount]
options = "metadata"

[boot]
systemd=true
```
setelah selesai, tekan ESC untuk keluar menu insert dan ':wq' untuk simpan dan keluar. selanjutnya lakukan perintah
```
wsl.exe --shutdown 
```
dari PowerShell untuk memulai ulang instans WSL. Setelah distribusi dimulai ulang, systemd harus berjalan. Ddapat mengonfirmasi menggunakan perintah :
```
systemctl list-unit-files --type=service
```
, yang akan menampilkan status layanan yang ada.

2. setelahnya maka jalankan perintah
```
sudo nvim /etc/systemd/system/zookeeper.service
```
untuk membuat file baru zookeeper.service dan masukan
```
[Unit]
Description=Apache zookeeper
Documentation=https://zookeeper.apache.org/
Requires=network.target remote-fs.target
After=network.target remote-fs.target

[Service]
Type=simple
User=root
ExecStart=/opt/kafka_2.13-3.7.0/bin/zookeeper-server-start.sh /opt/kafka_2.13-3.7.0/config/zookeeper.properties
ExecStop=/opt/kafka_2.13-3.7.0/bin/zookeeper-server-stop.sh
Restart=on-abnormal

[Install]
WantedBy=multi-user.target
```
pastikan user yang digunakan sesuai yang akan jalankan servicenya, dan sesuaikan juga dengan lokasi direktori tempat menyimpan file nya.

3. selanjutnya yaitu melakukan konfigurasi yang sama dimulai dengan membuat perintah
```
sudo nvim /etc/systemd/system/kafka.service
```
4.  untuk membuat file kafka.service dan lakukan insert dengan isi:
```
[Unit]
Description=Apache zookeeper
Documentation=https://zookeeper.apache.org/
Requires=network.target remote-fs.target
After=network.target remote-fs.target

[Service]
Type=simple
User=root
ExecStart=/opt/kafka_2.13-3.7.0/bin/zookeeper-server-start.sh /opt/kafka_2.13-3.7.0/config/zookeeper.properties
ExecStop=/opt/kafka_2.13-3.7.0/bin/zookeeper-server-stop.sh
Restart=on-abnormal

[Install]
WantedBy=multi-user.target
```
5. setelah kedua service sudah dibuat, maka dapat langsung menjalankan perintah kepada kafka.service menggunakan systemd dengan command:
```
sudo systemctl enable --now kafka.service
```
seharusnya kedua service baik zookeeper dan kafka sudah berjalan. untuk melakukan pengecekan statusnya, gunakan perintah 
```
systemctl status kafka
```
yang akan menunjukan status active(running) pada service kafka.
![Screenshot (10)](https://github.com/ferdyansahalfariz/belajar-linux/assets/96871156/7415dc6a-d120-4400-ae6a-9f681b6cfe1f)
